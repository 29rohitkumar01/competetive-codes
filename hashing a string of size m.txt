Hi % M = (((( Hi – 1 % M – ((s[i- 1] % M) * (Bm – 1 % M)) % M ) % M) * (B % M)) % M + s[i + m - 1] % M) % M